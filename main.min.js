var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.ASSUME_ES5=!1;
$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");
var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};
$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Object.values",function(a){return a?a:function(a){var b=[],d;for(d in a)$jscomp.owns(a,d)&&b.push(a[d]);return b}},"es8","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
$jscomp.polyfill("Array.prototype.flatMap",function(a){return a?a:function(a,c){for(var b=[],e=0;e<this.length;e++){var f=a.call(c,this[e],e,this);Array.isArray(f)?b.push.apply(b,f):b.push(f)}return b}},"es9","es5");$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(p){return!1}}function c(){}function d(a){var b=typeof a;return"object"===b&&null!==a||"function"===b}function e(a){if(!$jscomp.owns(a,g)){var b=new c;$jscomp.defineProperty(a,g,{value:b})}}function f(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
c)return a;e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var h=0,k=function(a){this.id_=(h+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,b){if(!d(a))throw Error("Invalid WeakMap key");e(a);if(!$jscomp.owns(a,g))throw Error("WeakMap key fail: "+
a);a[g][this.id_]=b;return this};k.prototype.get=function(a){return d(a)&&$jscomp.owns(a,g)?a[g][this.id_]:void 0};k.prototype.has=function(a){return d(a)&&$jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)};k.prototype.delete=function(a){return d(a)&&$jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)?delete a[g][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++h,c.set(b,d)):d="p_"+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
var MAX_WORKER_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=5,MAX_MINER_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=4,MAX_SCOUT_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1,PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2,PARALLEL_CONSTRUCTION_SITE_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1,PARALLEL_ROAD_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=
1,PARALLEL_EXTENSION_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1,PARALLEL_CONTAINER_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1,AUTOMATIC_ROAD_BUILD_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1E3,AUTOMATIC_ROAD_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1,Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants={MINER:1,WORKER:2,ARCHER:4,SCOUT:5,SLAYER:6},PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=
2E3,BUILD_ROAD_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1.5*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1.5*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
BUILD_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2.5*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
FILL_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2.5*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
FILL_STORE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2.5*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,REPAIR_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=0*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,REPAIR_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants={STRUCTURE_ROAD:0*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
STRUCTURE_CONTAINER:2*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,STRUCTURE_STORAGE:2*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,STRUCTURE_WALL:0*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,STRUCTURE_RAMPART:1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants},REDISTRIBUTE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=
1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,UPGRADE_HIGH_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=2*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,UPGRADE_LOW_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,ERR_NO_SPAWN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants=-200,
TERRAIN_SWAMP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants="swamp",TERRAIN_PLAIN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants="plain",TERRAIN_WALL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants="wall",module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants={AUTOMATIC_ROAD_BUILD_NUM:AUTOMATIC_ROAD_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,AUTOMATIC_ROAD_BUILD_TICKS:AUTOMATIC_ROAD_BUILD_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
BUILD_DEFAULT_PRIORITY:BUILD_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_EXTENSION_PRIORITY:BUILD_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_ROAD_PRIORITY:BUILD_ROAD_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_SPAWN_PRIORITY:BUILD_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,BUILD_TOWER_PRIORITY:BUILD_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
ERR_NO_SPAWN:ERR_NO_SPAWN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_DEFAULT_PRIORITY:FILL_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_EXTENSION_PRIORITY:FILL_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_SPAWN_PRIORITY:FILL_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,FILL_STORE_DEFAULT_PRIORITY:FILL_STORE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
FILL_TOWER_PRIORITY:FILL_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,MAX_MINER_NUM:MAX_MINER_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,MAX_SCOUT_NUM:MAX_SCOUT_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,MAX_WORKER_NUM:MAX_WORKER_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,PARALLEL_CONSTRUCTION_SITE_BUILD_NUM:PARALLEL_CONSTRUCTION_SITE_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
PARALLEL_CONTAINER_BUILD_NUM:PARALLEL_CONTAINER_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,PARALLEL_EXTENSION_BUILD_NUM:PARALLEL_EXTENSION_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,PARALLEL_ROAD_BUILD_NUM:PARALLEL_ROAD_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,PATH_REUSE_TICKS:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,PRIORITY_LEVEL_STEP:PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
REDISTRIBUTE_DEFAULT_PRIORITY:REDISTRIBUTE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,REPAIR_DEFAULT_PRIORITY:REPAIR_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,REPAIR_PRIORITY:REPAIR_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,Role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,TERRAIN_PLAIN:TERRAIN_PLAIN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,TERRAIN_SWAMP:TERRAIN_SWAMP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,
TERRAIN_WALL:TERRAIN_WALL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,UPGRADE_HIGH_PRIORITY:UPGRADE_HIGH_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,UPGRADE_LOW_PRIORITY:UPGRADE_LOW_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants};var LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging={INFO:0,WARNING:1,ERROR:2,toString:function(a){switch(a){case LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.ERROR:return"ERROR";case LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.WARNING:return"WARNING";case LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.INFO:return"INFO"}}},GLOBAL_LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging=
LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.ERROR;function log$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(a){return function(){if(a>=LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.ERROR){var b="["+LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.toString(a)+"] ";for(var c=0;c<arguments.length;c++)b+=JSON.stringify(arguments[c]);console.log(b)}}}
var error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging=log$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.ERROR),warning$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging=log$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.WARNING),info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging=log$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(LOG_LEVEL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.INFO),
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.error=error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.info=info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging.warning=warning$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging;Object.defineProperty(Source.prototype,"memory",{get:function(){Memory.sources||(Memory.sources={});if("object"===typeof Memory.sources)return Memory.sources[this.id]=Memory.sources[this.id]||{}},set:function(a){Memory.sources||(Memory.sources={});if("object"!==typeof Memory.sources)throw Error("Could not set source memory");Memory.sources[this.id]=a}});
Object.defineProperty(Source.prototype,"reservedSlots",{get:function(){void 0==this._reservedSlots&&(this.memory.reservedSlots=void 0==this.memory.reservedSlots?[]:this.memory.reservedSlots.filter(function(a){return Game.time<a}),this._reservedSlots=this.memory.reservedSlots);return this._reservedSlots},set:function(a){void 0===this._reservedSlots&&(this.memory.reservedSlots=a)}});Source.prototype.reserveSlot=function(a){this.reservedSlots.push(a);this.reservedSlots.sort()};
Source.prototype.hasFreeSpot=function(){return 0<this.pos.getAdjacentWalkables().length};Source.prototype.hasMiner=function(){return Memory.reservedSources&&0<Memory.reservedSources[this.id]};Source.prototype.reserveSource=function(){Memory.reservedSources=Memory.reservedSources||{};Memory.reservedSources[this.id]=Memory.reservedSources[this.id]||0;Memory.reservedSources[this.id]+=1};
Source.prototype.freeSource=function(){Memory.reservedSources=Memory.reservedSources||{};Memory.reservedSources[this.id]=Memory.reservedSources[this.id]||1;--Memory.reservedSources[this.id]};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Source={};function initGame$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(){Game.numCreeps=function(a){return Object.values(Game.creeps).filter(function(b){return!a||a(b)}).length};Game.getOurRooms=function(a){var b=Object.values(Game.flags).filter(function(a){return a.room}).map(function(a){return a.room}).filter(function(a){return a.controller&&a.controller.my});b.length||error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("No rooms found. Did you forget to set the flag?");b&&a&&
b.filter(function(b){return a(b)});return b||[]};Game.find=function(a,b){var c=[],d=Game.getOurRooms();d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next())c=c.concat(e.value.find(a,b));return c};Game.findMaxStoredResource=function(a){var b=Game.find(FIND_STRUCTURES,{filter:function(b){return(b.structureType===STRUCTURE_CONTAINER||b.structureType===STRUCTURE_STORAGE)&&0<b.store[a]}}).map(function(a){return a.store});b.sort(function(b,d){return d[a]-b[a]});return b.length?b[0][a]:0}}
function findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(a,b){b={all:[],remote_fighters:[],close_fighters:[],healers:[]};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value.findAllHostileCreeps(),b.all=b.all.concat(c.all),b.remote_fighters=b.remote_fighters.concat(c.remote_fighters),b.close_fighters=b.close_fighters.concat(c.close_fighters),b.healers=b.healers.concat(c.healers);return b}
function storedEnergy$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(){var a=Game.getOurRooms(),b=0;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())b+=c.value.storedEnergy();return b}
function getSpawns$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(a){var b=Game.getOurRooms(),c=[];b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())c=c.concat(d.value.find(FIND_MY_STRUCTURES,{filter:function(b){return b.structureType===STRUCTURE_SPAWN&&("function"!==typeof a||a(b))}}));return c}function getBiggestSpawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(){return Game.spawns.Spawn1}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game.findEnemyCreeps=findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game.getBiggestSpawn=getBiggestSpawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game.getSpawns=getSpawns$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game.initGame=initGame$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game.storedEnergy=storedEnergy$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game;Room.prototype.findAllHostileCreeps=function(){var a=this.find(FIND_HOSTILE_CREEPS),b=a.filter(function(a){return a.getActiveBodyparts(RANGED_ATTACK)}),c=a.filter(function(a){return a.getActiveBodyparts(ATTACK)}),d=a.filter(function(a){return a.getActiveBodyparts(HEAL)});return{all:a,remote_fighters:b,close_fighters:c,healers:d}};
Room.prototype.numCreeps=function(a){var b=this;return a&&"function"!==typeof a?(error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("base.numCreeps: filter is not a function."),0):Object.values(Game.creeps).filter(function(c){return(!a||a(c))&&c.room===b}).length};Room.prototype.findSpawns=function(a){return this.find(FIND_MY_STRUCTURES,{filter:function(b){return b.structureType===STRUCTURE_SPAWN&&("function"!==typeof a||a(b))}})||[]};
Room.prototype.getHostileStructures=function(a){return this.find(FIND_HOSTILE_STRUCTURES,{filter:function(b){return"function"!==typeof a||a(b)}})||[]};Room.prototype.inRoom=function(a){return 0>=a.x||0>=a.y||49<=a.x||49<=a.y?!1:!0};
Room.prototype.storedEnergy=function(){var a=this.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_CONTAINER}})||[],b=0;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())b+=c.value.store[RESOURCE_ENERGY];return b+=!this.storage||this.storage.store[RESOURCE_ENERGY]};
Room.prototype.getFreeCapacity=function(a){var b=this.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_CONTAINER}})||[],c=0;b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())c+=d.value.store.getFreeCapacity(a);return c+=!this.storage||this.storage.store.getFreeCapacity(a)};
Room.prototype.hasExcessEnergy=function(a){if(this.storedEnergy()>a)return!0;a=this.find(FIND_SOURCES_ACTIVE);a=$jscomp.makeIterator(a||[]);for(var b=a.next();!b.done;b=a.next())if(!b.value.hasMiner())return!0;return!1};Room.prototype.spawnKevin=function(){var a=this.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_SPAWN&&!a.spawning}});if(a.length)return a[0].spawnKevin()};
Room.prototype.spawnMiner=function(){var a=this.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_SPAWN&&!a.spawning}});return a.length?a[0].spawnMiner():""};Room.prototype.spawnCreep=function(a,b,c){var d=this.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_SPAWN&&!a.spawning}});return d.length&&d[0].allowSpawn()?d[0].spawnCreep(a,b,c):ERR_NO_SPAWN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants};
Room.prototype.allowSpawn=function(){var a=Game.numCreeps(),b=this.energyCapacityAvailable,c=this.energyAvailable;a=a*a*a+300;info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("spawn requires energy: ",Math.min(b,a)," we have ",c," at ",this);return c>=Math.min(b,a)};
Room.prototype.getCostMatrix=function(a,b){b||(b=0);a||(a=1);return{plainCost:Math.max(1,2*a-b),swampCost:Math.max(1,10*a-b),roomCallback:function(c){var d=new PathFinder.CostMatrix;c=Game.rooms[c];if(!c)return d;c.find(FIND_STRUCTURES).forEach(function(c){c.structureType===STRUCTURE_ROAD?d.set(c.pos.x,c.pos.y,Math.max(1,a-b)):c.structureType===STRUCTURE_CONTAINER||c.structureType===STRUCTURE_RAMPART&&c.my||d.set(c.pos.x,c.pos.y,255)});return d}}};
var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Room={};Creep.prototype.harvestClosest=function(){var a=this.pos.findClosestByPath(FIND_SOURCES_ACTIVE);a&&this.harvest(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#ffff00"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};
Creep.prototype.harvestFrom=function(a){if(a){var b=this.harvest(a);if(b===ERR_NOT_IN_RANGE||b===ERR_NOT_ENOUGH_RESOURCES)return this.moveTo(a,{visualizePathStyle:{stroke:"#ffff00"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}),!1}return!0};Creep.prototype.takeFrom=function(a){this.withdraw(a,RESOURCE_ENERGY)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#555500"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};
Creep.prototype.storeAt=function(a){this.transfer(a,RESOURCE_ENERGY)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#ff00ff"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};Creep.prototype.upgrade=function(a){this.upgradeController(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#00ffff"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};
Creep.prototype.buildStructure=function(a){this.build(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#0000ff"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};Creep.prototype.collectDroppedResource=function(a){var b=this.pickup(a);b==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#00ff00"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants});return b};
Creep.prototype.repairStructure=function(a){this.repair(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#00ff00"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};Creep.prototype.claimRoom=function(){this.claimController(this.room.controller)==ERR_NOT_IN_RANGE&&this.moveTo(this.room.controller,{visualizePathStyle:{stroke:"#ffffff"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};
Creep.prototype.moveToRoom=function(a){return this.room!=a.room?(this.moveTo(a,{visualizePathStyle:{stroke:"#000000"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}),!1):!0};Creep.prototype.fight=function(a){a&&this.attack(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#ff0000"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};
Creep.prototype.shoot=function(a){a&&this.rangedAttack(a)==ERR_NOT_IN_RANGE&&this.moveTo(a,{visualizePathStyle:{stroke:"#ff0000"},reusePath:PATH_REUSE_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants})};Creep.prototype.moveAwayFrom=function(a,b){a=PathFinder.search(this.pos,{pos:a.pos,range:b},{flee:!0}).path[0];this.move(this.pos.getDirectionTo(a))};
Creep.prototype.findOptimalEnergy=function(a,b){var c=this,d=this.store.getFreeCapacity(RESOURCE_ENERGY),e=d/(2*this.getActiveBodyparts(WORK)),f=Game.find(FIND_SOURCES_ACTIVE,{filter:function(a){return a.hasFreeSpot()||c.pos.inRangeTo(a.pos,1)}}),g=Game.find(FIND_DROPPED_RESOURCES,{filter:function(a){return a.amount>=d}}),h=Game.find(FIND_STRUCTURES,{filter:function(a){return(a.structureType===STRUCTURE_CONTAINER||a.structureType===STRUCTURE_STORAGE)&&a.store[RESOURCE_ENERGY]>=d}}),k=null;a=a||Infinity;
var l=this.getCostMatrix();g=PathFinder.search(this.pos,g.map(function(a){return{pos:a.pos,range:0}}),Object.assign(l,{maxCost:a,maxRooms:b||16}));!g.incomplete&&g.cost<a&&(a=g.cost,k=g.path.pop()||this.pos,k={type:FIND_DROPPED_RESOURCES,object:k.lookFor(LOOK_RESOURCES).find(function(a){return a.resourceType===RESOURCE_ENERGY})});g=PathFinder.search(this.pos,h.map(function(a){return{pos:a.pos,range:1}}),Object.assign(l,{maxCost:a,maxRooms:b||16}));!g.incomplete&&g.cost<a&&(a=g.cost,h=(g.path.pop()||
this.pos).getAdjacentStructures(function(a){return a.structure.structureType===STRUCTURE_STORAGE||a.structure.structureType===STRUCTURE_CONTAINER}),h=h.map(function(a){return a.structure}),h.length&&(h.sort(function(a,b){return b.store[RESOURCE_ENERGY]-a.store[RESOURCE_ENERGY]}),k={type:FIND_STRUCTURES,object:h[0]}));g=PathFinder.search(this.pos,f.map(function(a){return{pos:a.pos,range:1}}),Object.assign(l,{maxCost:a-e,maxRooms:b||16}));!g.incomplete&&g.cost+e<a&&(a=g.cost+e,b=g.path.pop()||this.pos,
k={type:FIND_SOURCES,object:b.getAdjacentSource()});return k};Creep.prototype.getCostMatrix=function(){var a=2*this.getActiveBodyparts(MOVE),b=this.body.length-this.getActiveBodyparts(MOVE);return this.room.getCostMatrix(b,a)};Creep.prototype.getRoadCosts=function(){var a=2*this.getActiveBodyparts(MOVE),b=this.body.length-this.getActiveBodyparts(MOVE);return Math.max(1,b-a)};
Creep.prototype.getPlainCosts=function(){var a=2*this.getActiveBodyparts(MOVE),b=this.body.length-this.getActiveBodyparts(MOVE);return Math.max(1,2*b-a)};Creep.prototype.getSwampCosts=function(){var a=2*this.getActiveBodyparts(MOVE),b=this.body.length-this.getActiveBodyparts(MOVE);return Math.max(1,10*b-a)};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Creep={};function getStoresWithEnergy$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a){return a.find(FIND_STRUCTURES,{filter:function(a){return(a.structureType==STRUCTURE_STORAGE||a.structureType==STRUCTURE_CONTAINER)&&0<a.store[RESOURCE_ENERGY]}})}
function handlePossibleRespawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(){if(Memory.main_spawn&&Memory.main_spawn!=Game.spawns.Spawn1.pos&&0===Object.values(Game.creeps).length){info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Detected respawn!");for(var a in Memory)Memory[a]=void 0}Memory.new_tasks=Memory.new_tasks||{};Memory.main_spawn=Game.spawns.Spawn1.pos}
function getFreeStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a){return a.pos.findClosestByPath(FIND_STRUCTURES,{filter:function(a){return(a.structureType==STRUCTURE_STORAGE||a.structureType==STRUCTURE_CONTAINER)&&0<a.store.getFreeCapacity(RESOURCE_ENERGY)}})}
function findNearestEnergyStored$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a){a||error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Called findNearestEnergyStored with underfined position.");return a.findClosestByPath(FIND_STRUCTURES,{filter:function(a){return(a.structureType==STRUCTURE_STORAGE||a.structureType==STRUCTURE_CONTAINER)&&0<a.store[RESOURCE_ENERGY]}})}
function getNoOwnerStructures$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a,b){return a.find(FIND_STRUCTURES,{filter:function(a){return a.structureType==b}})}function getTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a,b){return a.find(FIND_MY_STRUCTURES,{filter:function(a){return a.structureType==STRUCTURE_TOWER&&b(a)}})}
function findCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a){return"function"!==typeof a?(error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("base.findCreeps: filter is not a function."),0):Object.values(Game.creeps).filter(function(b){return a(b)})}
function findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a,b){var c=[];a.forEach(function(a){c=c.concat(a.find(FIND_HOSTILE_CREEPS,{filter:function(a){return a.getActiveBodyparts(ATTACK)||b(a)||a.getActiveBodyparts(RANGED_ATTACK)}}))});return c}function findNearestEnergySource$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a){return a.findClosestByPath(FIND_SOURCES_ACTIVE)}
function getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(){return Object.values(Game.flags).filter(function(a){return a.room}).map(function(a){return a.room}).filter(function(a){return!a.controller||!a.controller.my})||[]}function getUnclaimedFlags$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(){return Object.values(Game.flags).filter(function(a){return!a.room})}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.findCreeps=findCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.findEnemyCreeps=findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.findNearestEnergySource=findNearestEnergySource$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.findNearestEnergyStored=findNearestEnergyStored$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getFreeStore=getFreeStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getNoOwnerStructures=getNoOwnerStructures$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getRoomsToClaim=getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getStoresWithEnergy=getStoresWithEnergy$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getTowers=getTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.getUnclaimedFlags=getUnclaimedFlags$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base.handlePossibleRespawn=handlePossibleRespawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base;RoomPosition.prototype.getAdjacentContainer=function(a){var b=this.getAdjacentStructures();b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,c.structure.structureType===STRUCTURE_CONTAINER&&a(c.structure))return c.structure;return null};
RoomPosition.prototype.getAdjacentSource=function(a){var b=Game.rooms[this.roomName].lookForAtArea(LOOK_SOURCES,Math.max(0,this.y-1),Math.max(0,this.x-1),Math.min(49,this.y+1),Math.min(49,this.x+1),!0);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,!a||a(c.source))return c.source;return null};
RoomPosition.prototype.getAdjacentWalkables=function(){for(var a=[],b=-1;1>=b;++b)for(var c=-1;1>=c;++c)if(0!=c||0!=b){var d=new RoomPosition(this.x+b,this.y+c,this.roomName);Game.rooms[this.roomName].inRoom(d)&&d.isWalkable()&&a.push(d)}return a};RoomPosition.prototype.getAdjacentGenerallyWalkables=function(){for(var a=[],b=-1;1>=b;++b)for(var c=-1;1>=c;++c)if(0!=c||0!=b){var d=new RoomPosition(this.x+b,this.y+c,this.roomName);Game.rooms[this.roomName].inRoom(d)&&d.isGenerallyWalkable()&&a.push(d)}return a};
RoomPosition.prototype.isWalkable=function(){return!this.isGenerallyWalkable()||this.lookFor(LOOK_CREEPS).length?!1:!0};
RoomPosition.prototype.isGenerallyWalkable=function(){var a=this.lookFor(LOOK_TERRAIN);a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if(b.value===TERRAIN_WALL$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)return!1;b=this.lookFor(LOOK_STRUCTURES).concat(this.lookFor(LOOK_CONSTRUCTION_SITES));a={};b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;a={$jscomp$loop$prop$structure$65:a.$jscomp$loop$prop$structure$65},c=b.next())if(a.$jscomp$loop$prop$structure$65=c.value,
OBSTACLE_OBJECT_TYPES.find(function(a){return function(b){return b===a.$jscomp$loop$prop$structure$65.structureType}}(a)))return!1;return!0};RoomPosition.prototype.getAdjacentStructures=function(a){a=a||function(a){return!0};return Game.rooms[this.roomName].lookForAtArea(LOOK_STRUCTURES,Math.max(0,this.y-1),Math.max(0,this.x-1),Math.min(49,this.y+1),Math.min(49,this.x+1),!0).filter(a)};
RoomPosition.prototype.estimatePathCosts=function(a,b,c,d,e){b=1;Memory.estimatePathCosts=Memory.estimatePathCosts||{};Memory.estimatePathCosts[this.roomName]||initializePathCostCache$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(this.roomName);Memory.estimatePathCosts[a.roomName]||initializePathCostCache$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a.roomName);var f=Math.floor(a.x/10),g=Math.floor(a.y/10),h=Math.floor(this.x/10),k=Math.floor(this.y/10),l=
f+10*g,n=h+10*k;if(n!=l||this.roomName!=a.roomName){var m=computeCostsFromCache$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(this.roomName,n,a.roomName,l,c);if(-1!=m)return m}m=Memory.estimatePathCosts[a.roomName][f][g]++;var p=Memory.estimatePathCosts[this.roomName][h][k]++,q=Game.rooms[this.roomName].getCostMatrix();b=PathFinder.search(this,{pos:a,range:b},Object.assign(q,{maxCost:d||2E3,maxRooms:e||16}));if(b.incomplete)return Infinity;b=computeCachePathFromPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(b.path||
[]);c=computeCostsFromPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(b,c);100<m&&100<p&&(n!=l||this.roomName!=a.roomName)&&(setCachedPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(this.roomName,n,a.roomName,l,b),setCachedPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a.roomName,l,this.roomName,n,b),Memory.estimatePathCosts[a.roomName][f][g]=0,Memory.estimatePathCosts[this.roomName][h][k]=0);return c};
function computeCachePathFromPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a){var b={num_road:0,num_plain:0,num_swamp:0};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=c.lookFor(LOOK_TERRAIN),e=c.lookFor(LOOK_STRUCTURES).concat(c.lookFor(LOOK_CONSTRUCTION_SITES));c=!1;e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next())if(f.value.structureType===STRUCTURE_ROAD){b.num_road++;c=!0;break}d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=
d.next())e=e.value,c||(e===TERRAIN_SWAMP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants?b.num_swamp++:e===TERRAIN_PLAIN$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants&&b.num_plain++)}return b}
function computeCostsFromCache$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,b,c,d,e){return(a=getCachedPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,b,c,d))?computeCostsFromPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,e):-1}function computeCostsFromPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,b){return a.num_road*b.getRoadCosts()+a.num_plain*b.getPlainCosts()+a.num_swamp*b.getSwampCosts()}
function setCachedPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,b,c,d,e){Memory.path_costs=Memory.path_costs||{};Memory.path_costs[a]=Memory.path_costs[a]||{};Memory.path_costs[a][b]=Memory.path_costs[a][b]||{};Memory.path_costs[a][b][c]=Memory.path_costs[a][b][c]||{};Memory.path_costs[a][b][c][d]=Memory.path_costs[a][b][c][d]||{};Memory.path_costs[a][b][c][d]=e}
function getCachedPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a,b,c,d){return Memory.path_costs&&Memory.path_costs[a]&&Memory.path_costs[a][b]&&Memory.path_costs[a][b][c]&&Memory.path_costs[a][b][c][d]?Memory.path_costs[a][b][c][d]:null}
function initializePathCostCache$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition(a){Memory.estimatePathCosts[a]=[];for(var b=0;10>b;++b){Memory.estimatePathCosts[a].push([]);for(var c=0;10>c;++c)Memory.estimatePathCosts[a][b].push(0)}}
RoomPosition.prototype.findClosestActiveSource=function(a,b){var c=Game.getOurRooms()||[],d=[];c=$jscomp.makeIterator(c);for(var e=c.next();!e.done;e=c.next())d=d.concat(e.value.find(FIND_SOURCES_ACTIVE));return this.findClosestTarget(d,1,a||2E3,b||16)};
RoomPosition.prototype.findClosestStructure=function(a,b,c){var d=Game.getOurRooms()||[],e=[];d=$jscomp.makeIterator(d);for(var f=d.next();!f.done;f=d.next())e=e.concat(f.value.find(FIND_STRUCTURES,{filter:a}));return this.findClosestTarget(e,1,b||2E3,c||16)};
RoomPosition.prototype.findClosestTarget=function(a,b,c,d){if(!a||!a.length)return null;var e=null;c=c||2E3;a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next()){f=f.value;var g=PathFinder.search(this,{pos:f.pos,range:b},{maxCost:c,maxRooms:d||10});!g.incomplete&&g.cost<c&&(c=g.cost,e=f)}return e};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$RoomPosition={};var QueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task,CreepTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task,giveup_time$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task=250;function State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a){this.func=a}function Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,b){this.name=a;b&&(this.initial_state=b)}
Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.prototype.run=function(a){a.memory.task.current_state||(a.memory.task.current_state=0);if(a.memory.task.current_state>=this.state_array.length||a.memory.ticks>giveup_time$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task)return!1;this.state_array[a.memory.task.current_state].func(a)||(a.memory.task.current_state++,this.run(a));return a.memory.task.current_state>=this.state_array.length?!1:!0};
function takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a){if(0==a.store.getFreeCapacity(RESOURCE_ENERGY))return!1;a.memory.task.store_id||a.memory.task.source_id||Object.assign(a.memory.task,getEnergyForTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,a.memory.task).task);if(a.memory.task.store_id){var b=Game.getObjectById(a.memory.task.store_id);if(!b||0==b.store[RESOURCE_ENERGY])return!1;a.takeFrom(b);return!0}if(a.memory.task.source_id){b=Game.getObjectById(a.memory.task.source_id);
if(!b||0==b.energy)return!1;a.memory.energy_path_time&&(error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("reserve the slot "+a.memory.task.source_id),b.reserveSlot(Game.time+a.memory.energy_path_time),a.memory.energy_path_time=0);return a.harvestFrom(b)||b.hasFreeSpot()?!0:!1}if(a.memory.task.resource_id){b=Game.getObjectById(a.memory.task.resource_id);if(!b)return!1;a.collectDroppedResource(b);return!0}return!1}
function upgradeController$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a){var b=Game.getObjectById(a.memory.task.id);if(!b)return!1;a.upgrade(b);return 0==a.store[RESOURCE_ENERGY]?!1:!0}function fillStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a){var b=Game.getObjectById(a.memory.task.id);if(!b||0==a.store[RESOURCE_ENERGY]||0==b.store.getFreeCapacity(RESOURCE_ENERGY))return!1;a.storeAt(b);return!0}
function getEnergyForTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,b,c){info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("getEnergyForTask",b);var d={task:{},object:null};return!a.store[RESOURCE_ENERGY]&&b.id&&Game.getObjectById(b.id)?(a=a.findOptimalEnergy(c))?a.type==FIND_STRUCTURES?{task:{store_id:a.object.id},object:a.object}:a.type==FIND_SOURCES?{task:{source_id:a.object.id},object:a.object}:{task:{drop_id:a.object.id},object:a.object}:d:d}
function findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,b){return Memory.new_tasks[a].find(function(a){return a.id===b})}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.State=State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.Task=Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.fillStructure=fillStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.findQueueTask=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.getEnergyForTask=getEnergyForTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.takeFromStore=takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task.upgradeController=upgradeController$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("kite",null);
function goToRoomWithSourceKeeper$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper(a){if(!a.memory.task.id){var b=getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value.find(FIND_HOSTILE_STRUCTURES,{filter:{structureType:STRUCTURE_KEEPER_LAIR}}),0<c.length){a.memory.task.id=c[0].id;break}}if(!a.memory.task.id)return!1;b=Game.getObjectById(a.memory.task.id);if(!b||b.room.name===
a.room.name)return!1;a.moveTo(b);return!0}function attackTarget$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper(a){if(!a.memory.task.target_id){var b=a.pos.findClosestByPath(FIND_HOSTILE_CREEPS,{filter:function(a){return"Source Keeper"===a.owner.username}});if(!b)return!1;a.memory.task.target_id=b.id}b=Game.getObjectById(a.memory.task.target_id);if(!b)return!1;a.fight(b);return!0}
function getCreepBody$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper(){return[TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,TOUGH,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,MOVE,ATTACK,ATTACK,ATTACK,ATTACK,ATTACK,ATTACK,ATTACK]}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(goToRoomWithSourceKeeper$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(attackTarget$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper)];
var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper.getCreepBody=getCreepBody$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper;function getMaxMinerNum$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(a){var b=a.find(FIND_SOURCES);a=0;b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())a+=Math.min(1,c.value.pos.getAdjacentWalkables().length);return a}
function monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(){for(var a=Game.numCreeps(function(a){return a.memory.role==Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SCOUT}),b=0<getUnclaimedFlags$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base().length,c={},d=$jscomp.makeIterator(Game.getOurRooms()),e=d.next();!e.done;c={$jscomp$loop$prop$room$67:c.$jscomp$loop$prop$room$67},e=d.next()){c.$jscomp$loop$prop$room$67=e.value;Game.numCreeps(function(a){return function(b){return b.memory.role==
Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.MINER&&b.room===a.$jscomp$loop$prop$room$67}}(c));getMaxMinerNum$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(c.$jscomp$loop$prop$room$67);e=c.$jscomp$loop$prop$room$67.findSpawns();e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next())f=f.value,b&&a<MAX_SCOUT_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants&&f.spawnScout()===OK&&(a+=1)}b=getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();
a={};b=$jscomp.makeIterator(b);for(e=b.next();!e.done;a={$jscomp$loop$prop$room$51$69:a.$jscomp$loop$prop$room$51$69},e=b.next())a.$jscomp$loop$prop$room$51$69=e.value,0<a.$jscomp$loop$prop$room$51$69.find(FIND_HOSTILE_STRUCTURES,{filter:{structureType:STRUCTURE_KEEPER_LAIR}}).length&&1>Game.numCreeps(function(a){return function(b){return b.memory.role==Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SLAYER&&b.room===a.$jscomp$loop$prop$room$51$69}}(a))&&getBiggestSpawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game().spawnSlayer()}
StructureSpawn.prototype.spawnSlayer=function(){var a="Ulf"+Game.time,b=getCreepBody$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper();return this.allowSpawn()?this.spawnCreep(b,a,{memory:{role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SLAYER}}):ERR_NOT_ENOUGH_ENERGY};
StructureSpawn.prototype.spawnKevin=function(){for(var a="Kevin"+Game.time,b=[MOVE,WORK,CARRY,MOVE],c=[MOVE,WORK,CARRY,MOVE],d=0;0==this.spawnCreep(c,a,{dryRun:!0});)c.push(b[d]),d=(d+1)%b.length;c.pop();b=[CARRY,MOVE];for(d=0;0==this.spawnCreep(c,a,{dryRun:!0});)c.push(b[d]),d=(d+1)%b.length;c.pop();return this.allowSpawn()?(this.spawnCreep(c,a,{memory:{role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.WORKER}}),a):""};
StructureSpawn.prototype.spawnMiner=function(){for(var a="Lars"+Game.time,b=[WORK],c=[WORK,CARRY,MOVE,WORK,WORK],d=0;0==this.spawnCreep(c,a,{dryRun:!0})&&!(c.push(b[d]),d=(d+1)%b.length,8<c.length););c.pop();return this.allowSpawn()&&this.spawnCreep(c,a,{memory:{role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.MINER}})===OK?a:""};
StructureSpawn.prototype.spawnScout=function(){var a="Scouty"+Game.time,b=[CLAIM,MOVE,MOVE];return 2<=b.length?this.spawnCreep(b,a,{memory:{role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SCOUT}}):ERR_NOT_ENOUGH_ENERGY};
StructureSpawn.prototype.spawnArcher=function(){info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("spawning archer");for(var a="Legolas"+Game.time,b=[MOVE,MOVE,RANGED_ATTACK],c=[MOVE,RANGED_ATTACK],d=0;0==this.spawnCreep(c,a,{dryRun:!0});)c.push(b[d]),d=(d+1)%b.length;c.pop();if(1>=c.length)return ERR_NOT_ENOUGH_ENERGY;for(;0==this.spawnCreep(c,a,{dryRun:!0});)c.unshift(TOUGH),d=(d+1)%b.length;c.shift();return this.spawnCreep(c,a,{memory:{role:Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.ARCHER}})};
function spawnArcherInRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(a){a=a.findSpawns();return 0<a.length?a[0].spawnArcher():-1}
StructureSpawn.prototype.allowSpawn=function(){var a=Game.numCreeps(),b=Game.getOurRooms().length;if(!b)return!1;var c=Math.floor(a/b);a=this.room.energyCapacityAvailable;b=this.room.energyAvailable;c=c*c*c*c*c+300;info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("spawn requires energy: ",Math.min(a,c)," we have ",b," at ",this.room);return b>=Math.min(a,c)};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine.monitor=monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine.spawnArcherInRoom=spawnArcherInRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine;function monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Defense(){var a=Game.getOurRooms();getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();getBiggestSpawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game();a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var c=b.numCreeps(function(a){return a.memory.role==Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.ARCHER});if(0<b.getHostileStructures().length||b.findAllHostileCreeps().all.length)if(info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b.name,
" is under attack"),!b.controller.safeMode&&!b.controller.safeModeCooldown&&b.controller.safeModeAvailable){if(b.controller.activateSafeMode(),2>c){spawnArcherInRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(b);break}}else if(!b.controller.safeMode&&5>c){spawnArcherInRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine(b);break}}}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Defense={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Defense.monitor=monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Defense;StructureTower.prototype.repairClosest=function(){var a=this.pos.findClosestByRange(FIND_STRUCTURES,{filter:function(a){return a.hits&&a.hits<a.hitsMax}});a&&a.structureType!=STRUCTURE_WALL&&this.repair(a)};StructureTower.prototype.attackClosest=function(){var a=this.pos.findClosestByRange(FIND_HOSTILE_CREEPS,{filter:function(a){return 0<a.pos.x&&0<a.pos.y&&49>a.pos.y&&49>a.pos.x}});return a?(this.attack(a),!0):!1};
StructureTower.prototype.healClosest=function(a){var b=this.pos.findClosestByRange(FIND_MY_CREEPS,{filter:function(b){return b.hits<b.hitsMax&&(!a||a(b))}});return b?(this.heal(b),!0):!1};
function operateTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Tower(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_MY_STRUCTURES,{filter:function(a){return a.structureType==STRUCTURE_TOWER&&10<=a.store[RESOURCE_ENERGY]}}))});a.forEach(function(a){a.room.controller&&a.room.controller.safeMode?a.repairClosest()||a.healClosest()||a.attackClosest(function(a){return!0}):a.healClosest(function(a){return a.getActiveBodyparts(RANGED_ATTACK)||a.getActiveBodyparts(ATTACK)||
a.getActiveBodyparts(HEAL)})||a.attackClosest()||a.healClosest(function(a){return!0})||a.repairClosest()})}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Tower={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Tower.operateTowers=operateTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Tower;function Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(a,b,c){this.pos=a;this.name=c;this.room=Game.rooms[a.roomName];Memory.creeps[c]=Memory.creeps[c]||{};this.memory=Memory.creeps[c];this.body=b.map(function(a){return{type:a,boost:"",hits:1E3}});this.getActiveBodyparts=function(a){return b.filter(function(b){return b==a}).length};this.store={energy:0,getCapacity:function(a){return 50*b.filter(function(a){return a==CARRY}).length},getFreeCapacity:function(a){return 50*
b.filter(function(a){return a==CARRY}).length}};this.findOptimalEnergy=Creep.prototype.findOptimalEnergy;this.getCostMatrix=Creep.prototype.getCostMatrix;this.getRoadCosts=Creep.prototype.getRoadCosts;this.getPlainCosts=Creep.prototype.getPlainCosts;this.getSwampCosts=Creep.prototype.getSwampCosts;this.say=function(a){return error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("say ",a)}}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep.Frankencreep=Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep;function BuildTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(){this.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(buildStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build)]}
function buildStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(a){var b=Game.getObjectById(a.memory.task.id);if(!b)return!1;a.buildStructure(b);return 0==a.store[RESOURCE_ENERGY]?!1:!0}BuildTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.prototype=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("build",null);var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build=new BuildTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build;
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_MY_CONSTRUCTION_SITES))});a.sort(function(a,b){return b.progress-a.progress});Memory.new_tasks.build=Memory.new_tasks.build||[];for(var b=$jscomp.makeIterator(a),c=b.next();!c.done;c=b.next())c=c.value,findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("build",c.id)||(c={id:c.id,name:"build",priority:0},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(c),
Memory.new_tasks.build.push(c));for(b=0;b<Memory.new_tasks.build.length;b++)c=Memory.new_tasks.build[b],Game.getObjectById(c.id)||(info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Finished building task",c),Memory.new_tasks.build.splice(b,1),b--)};
function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(a){switch(Game.getObjectById(a.id).structureType){case STRUCTURE_ROAD:a.priority=BUILD_ROAD_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;break;case STRUCTURE_TOWER:a.priority=BUILD_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;break;case STRUCTURE_EXTENSION:a.priority=BUILD_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;
break;case STRUCTURE_SPAWN:a.priority=BUILD_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;break;default:a.priority=BUILD_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.take=function(a,b){if(!Game.getObjectById(b.id))return null;a=a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY);b.expected_progress=(b.expected_progress||0)+a;reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(b);var c={};c.creep_exp_progress=a;c.id=b.id;c.name=b.name;return c};
function reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(a){var b=Game.getObjectById(a.id);b?(b=(b.progress+(a.expected_progress||0))/b.progressTotal,1<=b?a.priority=0:(prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(a),a.priority+=b*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)):a.priority=0}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.estimateTime=function(a,b,c){var d=Game.getObjectById(b.id);if(!d||0==a.getActiveBodyparts(WORK))return Infinity;b=Math.min(d.progressTotal-d.progress,a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY))/(5*a.getActiveBodyparts(WORK));if(!a.store[RESOURCE_ENERGY]){var e=a.findOptimalEnergy(c-b);if(!e||!e.object)return Infinity;var f=0;if(e.type==FIND_SOURCES){if(0==a.getActiveBodyparts(WORK))return Infinity;f=a.store.getFreeCapacity(RESOURCE_ENERGY)/
(2*a.getActiveBodyparts(WORK))}var g=a.pos.estimatePathCosts(e.object.pos,1,a,c-f-b);if(Infinity<=g)return Infinity;a=e.object.pos.estimatePathCosts(d.pos,3,a,c-f-g-b);return Infinity<=a?Infinity:a+g+f+b}return a.pos.estimatePathCosts(d.pos,3,a,c-b)+b};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.spawn=function(a,b){if(!b.allowSpawn())return"";var c=[MOVE,CARRY,WORK],d=[MOVE,CARRY,WORK],e="McGregor"+Game.time,f=Game.getObjectById(a.id),g=f.pos.findClosestStructure(function(a){return a.structureType===STRUCTURE_CONTAINER||a.structureType===STRUCTURE_STORAGE});if(!g)return b.spawnKevin();for(f=f.progressTotal-f.progress;0==b.spawnCreep(d,e,{dryRun:!0});){for(var h=MOVE,k=0,l=$jscomp.makeIterator(c),n=l.next();!n.done;n=
l.next()){n=n.value;d.push(n);var m=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(g.pos,d,"Franky"),p=50*d.filter(function(a){return a==CARRY}).length;m=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.estimateTime(m,a,p/k);null!=m&&Infinity!=m&&(p=Math.min(f,p)/m,k<p&&(k=p,h=n));d.pop()}d.push(h)}d.pop();return 3<d.length&&b.spawnCreep(d,e,{})==OK?e:""};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.finish=function(a,b){if(a=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id))a.expected_progress-=b.creep_exp_progress,reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build(a)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.creepAfter=function(a,b){b=Game.getObjectById(b.id);var c=b.pos.getAdjacentGenerallyWalkables();if(0==c.length)return error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b," is unreachable!"),null;c=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(c[0],a.body.map(function(a){return a.type}),"Franky");var d=a.store[RESOURCE_ENERGY]||a.store.getFreeCapacity(RESOURCE_ENERGY);a=Math.min(b.progressTotal-
b.progress,a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY));c.store[RESOURCE_ENERGY]=d-a;return c};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build;function RepairTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(){this.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(repairStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair)]}
RepairTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.prototype=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("repair",null);var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair=new RepairTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair;
function repairStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(a){var b=Game.getObjectById(a.memory.task.id);if(!b)return!1;a.repairStructure(b);return 0==a.store[RESOURCE_ENERGY]||b.hits==b.hitsMax?!1:!0}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_STRUCTURES,{filter:function(a){return a.hits&&a.hits<a.hitsMax&&a.structureType!==STRUCTURE_ROAD}}))});Memory.new_tasks.repair=Memory.new_tasks.repair||[];for(var b={},c=$jscomp.makeIterator(a),d=c.next();!d.done;b={$jscomp$loop$prop$structure$71:b.$jscomp$loop$prop$structure$71},d=c.next())b.$jscomp$loop$prop$structure$71=d.value,
Memory.new_tasks.repair.find(function(a){return function(b){return b.id==a.$jscomp$loop$prop$structure$71.id}}(b))||(d={id:b.$jscomp$loop$prop$structure$71.id,priority:500,name:"repair"},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(d),Memory.new_tasks.repair.push(d));for(b=0;b<Memory.new_tasks.repair.length;b++)c=Game.getObjectById(Memory.new_tasks.repair[b].id),c&&c.hits!=c.hitsMax||(Memory.new_tasks.repair.splice(b,1),b--);info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Repair tasks: ",
Memory.new_tasks.repair)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.estimateTime=function(a,b,c){var d=Game.getObjectById(b.id);if(!d||0==a.getActiveBodyparts(WORK))return Infinity;b=Math.min((d.hitsMax-d.hits)/100,a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY))/a.getActiveBodyparts(WORK);if(!a.store[RESOURCE_ENERGY]){var e=a.findOptimalEnergy(c-b);if(!e||!e.object)return Infinity;var f=0;if(e.type==FIND_SOURCES){if(0==a.getActiveBodyparts(WORK))return Infinity;f=a.store.getFreeCapacity(RESOURCE_ENERGY)/
(2*a.getActiveBodyparts(WORK))}var g=a.pos.estimatePathCosts(e.object.pos,1,a,c-f-b);if(Infinity<=g)return Infinity;a=e.object.pos.estimatePathCosts(d.pos,3,a,c-f-g-b);return Infinity<=a?Infinity:a+g+f+b}return a.pos.estimatePathCosts(d.pos,3,a,c-b)+b};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.take=function(a,b){if(!Game.getObjectById(b.id))return null;a=100*(a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY));b.expected_hits=(b.expected_hits||0)+a;reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(b);var c={};c.creep_exp_hits=a;c.id=b.id;c.name=b.name;return c};
function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(a){var b=Game.getObjectById(a.id);a.priority=REPAIR_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants[b.structureType];a.priority||(a.priority=REPAIR_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)}
function reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(a){var b=Game.getObjectById(a.id);b?(b=(b.hits+(a.expected_hits||0))/b.hitsMax,1<=b?a.priority=0:(prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(a),a.priority+=(1-b)*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)):a.priority=0}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.finish=function(a,b){(a=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id))&&a.expected_hits&&(a.expected_hits-=b.creep_exp_hits,reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair(a))};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.spawn=function(a,b){if(b.allowSpawn()){var c=[MOVE,CARRY,WORK],d=[MOVE,CARRY,WORK],e="Mario"+Game.time,f=Game.getObjectById(a.id),g=f.pos.findClosestStructure(function(a){return a.structureType===STRUCTURE_CONTAINER||a.structureType===STRUCTURE_STORAGE});if(!g)return b.spawnKevin();f=(f.hitsMax-f.hits)/100;for(var h=0;0==b.spawnCreep(d,e,{dryRun:!0});){for(var k="none",l=$jscomp.makeIterator(c),n=l.next();!n.done;n=l.next()){n=
n.value;d.push(n);var m=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(g.pos,d,"Franky"),p=50*d.filter(function(a){return a==CARRY}).length;m=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.estimateTime(m,a,p/h);null!=m&&Infinity!=m&&(p=Math.min(f,p)/m,h<p&&(h=p,k=n));d.pop()}"none"!==k&&d.push(k)}d.pop();return 3<d.length&&b.spawnCreep(d,e,{})==OK?e:""}};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.creepAfter=function(a,b){b=Game.getObjectById(b.id);var c=b.pos.getAdjacentGenerallyWalkables();if(0==c.length)return error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b," is unreachable!"),null;c=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(c[0],a.body.map(function(a){return a.type}),"Franky");var d=a.store[RESOURCE_ENERGY]||a.store.getFreeCapacity(RESOURCE_ENERGY);a=
Math.min((b.hitsMax-b.hits)/100,a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY));c.store[RESOURCE_ENERGY]=d-a;return c};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("fill_structure",null);
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_MY_STRUCTURES,{filter:function(a){return(a.structureType==STRUCTURE_SPAWN||a.structureType==STRUCTURE_EXTENSION||a.structureType==STRUCTURE_TOWER)&&0<a.store.getFreeCapacity(RESOURCE_ENERGY)}}))});Memory.new_tasks.fill_structure=Memory.new_tasks.fill_structure||[];for(var b={},c=$jscomp.makeIterator(a),d=c.next();!d.done;b=
{$jscomp$loop$prop$structure$73:b.$jscomp$loop$prop$structure$73},d=c.next())b.$jscomp$loop$prop$structure$73=d.value,Memory.new_tasks.fill_structure.find(function(a){return function(b){return b.id==a.$jscomp$loop$prop$structure$73.id}}(b))||(d={id:b.$jscomp$loop$prop$structure$73.id||"",name:"fill_structure",priority:0},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(d,b.$jscomp$loop$prop$structure$73.structureType),Memory.new_tasks.fill_structure.push(d));
for(b=0;b<Memory.new_tasks.fill_structure.length;b++)c=Game.getObjectById(Memory.new_tasks.fill_structure[b].id),c&&0!=c.store.getFreeCapacity(RESOURCE_ENERGY)||(Memory.new_tasks.fill_structure.splice(b,1),b--)};
function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(a,b){Game.getObjectById(a.id);switch(b){case STRUCTURE_SPAWN:a.priority=FILL_SPAWN_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;break;case STRUCTURE_EXTENSION:a.priority=FILL_EXTENSION_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;break;case STRUCTURE_TOWER:a.priority=FILL_TOWER_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;
break;default:a.priority=FILL_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.take=function(a,b){if(!Game.getObjectById(b.id))return null;a=a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY);b.expected_fillup=b.expected_fillup?b.expected_fillup+a:a;reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(b);var c={};c.creep_exp_fill=a;c.id=b.id;c.name=b.name;return c};
function reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(a){a.expected_fillup||(a.expected_fillup=0);var b=a.expected_fillup,c=Game.getObjectById(a.id);!c||b>=c.store.getFreeCapacity(RESOURCE_ENERGY)?a.priority=0:prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(a,c.structureType)}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.finish=function(a,b){(a=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id))&&a.expected_fillup&&(a.expected_fillup-=b.creep_exp_fillup);a&&reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure(a)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.estimateTime=function(a,b,c){var d=Game.getObjectById(b.id);if(!d)return Infinity;if(!a.store[RESOURCE_ENERGY]){var e=a.findOptimalEnergy(c);if(!e||!e.object)return Infinity;b=0;if(e.type==FIND_SOURCES){if(0==a.getActiveBodyparts(WORK))return Infinity;b=a.store.getFreeCapacity(RESOURCE_ENERGY)/(2*a.getActiveBodyparts(WORK))}var f=a.pos.estimatePathCosts(e.object.pos,1,a,c-b);if(Infinity<=f)return Infinity;a.memory.energy_path_time=
f;a=e.object.pos.estimatePathCosts(d.pos,1,a,c-b-f);return Infinity<=a?Infinity:a+f+b}return a.pos.estimatePathCosts(d.pos,1,a,c)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.spawn=function(a,b){if(500<b.room.storedEnergy()){var c=[MOVE,CARRY];a=[MOVE,CARRY]}else c=[MOVE,MOVE,CARRY,WORK],a=[MOVE,MOVE,CARRY,WORK];for(var d="Muli"+Game.time,e=0;0==b.spawnCreep(c,d,{dryRun:!0});)c.push(a[e]),e=(e+1)%a.length;c.pop();return 3<c.length&&b.spawnCreep(c,d,{})==OK?d:""};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.creepAfter=function(a,b){b=Game.getObjectById(b.id);var c=b.pos.getAdjacentGenerallyWalkables();if(0==c.length)return error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b," is unreachable!"),null;c=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(c[0],a.body.map(function(a){return a.type}),"Franky");a=a.store[RESOURCE_ENERGY]||a.store.getFreeCapacity(RESOURCE_ENERGY);
b=Math.min(a,b.store.getFreeCapacity(RESOURCE_ENERGY));c.store[RESOURCE_ENERGY]=a-b;return c};task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(fillStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task)];
var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("claim_room",null);task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(goToRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(claimRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom)];
function goToRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom(a){if(!a.memory.task.id){var b=getUnclaimedFlags$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();if(0<b.length)a.memory.task.id=b[0].name;else return!1}b=Game.flags[a.memory.task.id];if(!b||b.room===a.room)return!1;a.moveToRoom(b);return!0}
function claimRoom$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom(a){var b=Game.flags[a.memory.task.id];if(!b||b.room!==a.room)return!1;if(b.room.controller){if(b.room.controller.my)return!1;a.claimRoom()}else a.moveTo(b.pos);return!0}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("upgrade",null);
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a.push(b.controller)});Memory.new_tasks.upgrade=Memory.new_tasks.upgrade||[];for(var b={},c=$jscomp.makeIterator(a),d=c.next();!d.done;b={$jscomp$loop$prop$structure$75:b.$jscomp$loop$prop$structure$75},d=c.next())b.$jscomp$loop$prop$structure$75=d.value,Memory.new_tasks.upgrade.find(function(a){return function(b){return b.id==a.$jscomp$loop$prop$structure$75.id}}(b))||
(d={id:b.$jscomp$loop$prop$structure$75.id,priority:UPGRADE_HIGH_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,name:"upgrade"},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade(d),Memory.new_tasks.upgrade.push(d));for(b=0;b<Memory.new_tasks.upgrade.length;b++)a=Game.getObjectById(Memory.new_tasks.upgrade[b].id),a&&a.my||(Memory.new_tasks.upgrade.splice(b,1),b--)};
function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade(a){a.priority=UPGRADE_HIGH_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.finish=function(a,b){(a=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id))&&prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade(a)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.take=function(a,b){a={};a.id=b.id;a.name=b.name;b.priority=UPGRADE_LOW_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;return a};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.estimateTime=function(a,b,c){error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("calculating estimateTime for upgrade");var d=Game.getObjectById(b.id);if(!d||0==a.getActiveBodyparts(WORK))return Infinity;b=(a.store[RESOURCE_ENERGY]||a.store.getCapacity(RESOURCE_ENERGY))/a.getActiveBodyparts(WORK);if(!a.store[RESOURCE_ENERGY]){var e=a.findOptimalEnergy(c-b);if(!e||!e.object)return Infinity;var f=0;if(e.type==
FIND_SOURCES){if(0==a.getActiveBodyparts(WORK))return Infinity;f=a.store.getFreeCapacity(RESOURCE_ENERGY)/(2*a.getActiveBodyparts(WORK))}var g=a.pos.estimatePathCosts(e.object.pos,1,a,c-f-b);if(Infinity<=g)return Infinity;a=e.object.pos.estimatePathCosts(d.pos,3,a,c-f-g-b);if(Infinity<=a)return Infinity;error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(" time is ",a+g+f+b);return a+g+f+b}a=a.pos.estimatePathCosts(d.pos,3,a,c-b);if(Infinity<=a)return Infinity;error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(" time is ",
a+b);return a+b};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.spawn=function(a,b){if(!b.allowSpawn())return"";var c=[MOVE,CARRY,WORK],d=[MOVE,CARRY,WORK],e="Ash"+Game.time,f=Game.getObjectById(a.id).pos.findClosestStructure(function(a){return a.structureType===STRUCTURE_CONTAINER||a.structureType===STRUCTURE_STORAGE});if(!f)return b.spawnKevin();for(;0==b.spawnCreep(d,e,{dryRun:!0});){for(var g=MOVE,h=0,k=$jscomp.makeIterator(c),l=k.next();!l.done;l=k.next()){l=l.value;d.push(l);var n=
new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(f.pos,d,"Franki"),m=50*d.filter(function(a){return a==CARRY}).length;n=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.estimateTime(n,a,m/h);null!=n&&Infinity!=n&&(m/=n,h<m&&(h=m,g=l));d.pop()}d.push(g)}d.pop();return 3<d.length&&b.spawnCreep(d,e,{})==OK?e:""};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.creepAfter=function(a,b){b=Game.getObjectById(b.id);var c=b.pos.getAdjacentGenerallyWalkables();return 0==c.length?(error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b," is unreachable!"),null):new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(c[0],a.body.map(function(a){return a.type}),"Franky")};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(upgradeController$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task)];var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade;function harvest$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore(a){a.memory.task.store_id=void 0;if(!a.memory.task.id)return a.say("no task id"),!1;var b=Game.getObjectById(a.memory.task.id);return b?a.harvestFrom(b)||b.hasFreeSpot()?0==a.store.getFreeCapacity(RESOURCE_ENERGY)?(a.say("full"),!1):!0:(a.say("no spot"),!1):(a.say("source empty"),!1)}
function fillStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore(a){var b=null;if(a.memory.task.store_id)b=Game.getObjectById(a.memory.task.store_id);else if(b=a.pos.findClosestStructure(function(b){return(b.structureType===STRUCTURE_STORAGE||b.structureType===STRUCTURE_CONTAINER)&&b.store.getFreeCapacity(RESOURCE_ENERGY)>=a.store[RESOURCE_ENERGY]}))a.memory.task.store_id=b.id;if(!b||0==b.store.getFreeCapacity(RESOURCE_ENERGY))return a.memory.task.store_id=void 0,!1;a.storeAt(b);
return 0==a.store[RESOURCE_ENERGY]?!1:!0}var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("fill_store",null);task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(harvest$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(fillStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore)];
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_SOURCES))});Memory.new_tasks.fill_store=Memory.new_tasks.fill_store||[];for(var b={},c=$jscomp.makeIterator(a),d=c.next();!d.done;b={$jscomp$loop$prop$source$77:b.$jscomp$loop$prop$source$77},d=c.next())b.$jscomp$loop$prop$source$77=d.value,0==b.$jscomp$loop$prop$source$77.room.find(FIND_STRUCTURES,{filter:{structureType:STRUCTURE_CONTAINER}}).length||
Memory.new_tasks.fill_store.find(function(a){return function(b){return b.id===a.$jscomp$loop$prop$source$77.id}}(b))||(d={id:b.$jscomp$loop$prop$source$77.id||"",name:"fill_store",priority:0,num_creeps:0},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore(d),Memory.new_tasks.fill_store.push(d));for(b=0;b<Memory.new_tasks.fill_store.length;b++)c=Game.getObjectById(Memory.new_tasks.fill_store[b].id),c||(Memory.new_tasks.fill_store.splice(b,1),b--),0==c.room.find(FIND_STRUCTURES,
{filter:{structureType:STRUCTURE_CONTAINER}}).length&&(Memory.new_tasks.fill_store.splice(b,1),b--)};
function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore(a){var b=Game.getObjectById(a.id);b&&(b=b.room.getFreeCapacity(RESOURCE_ENERGY)/(b.room.getFreeCapacity(RESOURCE_ENERGY)+b.room.storedEnergy()),a.priority=FILL_STORE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants+b*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.take=function(a,b){b.priority=0;b.num_creeps=b.num_creeps||0;b.num_creeps+=1;a={};a.id=b.id;a.name=b.name;Game.getObjectById(a.id).reserveSource();return a};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.finish=function(a,b){var c=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id);c&&(--c.num_creeps,0>=c.num_creeps&&(c.num_creeps=0,prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore(c)));(b=Game.getObjectById(b.id))&&b.freeSource();Game.creeps[a.name]&&a.say("finishing")};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.estimateTime=function(a,b,c){var d=Game.getObjectById(b.id);if(!d)return 0;if(!a.getActiveBodyparts(WORK))return Infinity;b=Math.min(d.energy,a.store.getCapacity(RESOURCE_ENERGY))/(2*a.getActiveBodyparts(WORK));a=a.pos.estimatePathCosts(d.pos,1,a,c);return b+a};task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.creepAfter=function(a,b){return null};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.spawn=function(a,b){return b.spawnMiner()};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("kite",null);
function getTarget$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite(a){var b=Game.getOurRooms();b=findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(b,function(a){return!0}).all;var c=getRoomsToClaim$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();findEnemyCreeps$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game(c,function(a){return!0});(c=a.pos.findClosestByRange(b))||(c=a.pos.findClosestTarget(b,3,1E3,5));if(!c)return!1;a.memory.task.id=
c.id;return!1}function kiteTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite(a){var b=a.memory.task.id&&Game.getObjectById(a.memory.task.id);if(!b)return b=Object.values(Game.flags),(b=a.pos.findClosestByRange(b))&&!a.pos.inRangeTo(b,5)&&a.moveTo(b),!0;b.room.controller&&b.room.controller.safeMode||!a.pos.inRangeTo(b.pos,2)||!b.getActiveBodyparts(ATTACK)?a.shoot(b):a.moveAwayFrom(b,3);return!0}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite.take=function(a,b){1E3<=b.priority&&(b.priority-=500);a=a.memory.task.id&&Game.getObjectById(a.memory.task.id);var c={};a&&(c.id=a.id);c.id=b.id;c.name=b.name;return c};task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite.isSuitable=function(a,b){return a.memory.role===Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.ARCHER};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(getTarget$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(kiteTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite)];var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite={};
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite;var task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute=new Task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task("redistribute",null);function findBestAvailableContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(a){return a.findClosestByPath(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_CONTAINER&&a.store[RESOURCE_ENERGY]>.5*a.store.getCapacity(RESOURCE_ENERGY)}})}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.updateQueue=function(){var a=[];Game.getOurRooms().forEach(function(b){a=a.concat(b.find(FIND_MY_STRUCTURES,{filter:function(a){return a.structureType==STRUCTURE_STORAGE&&500<=a.store.getFreeCapacity(RESOURCE_ENERGY)}}))});for(var b=0;b<Memory.new_tasks.redistribute.length;b++){var c=Game.getObjectById(Memory.new_tasks.redistribute[b].id);if(findBestAvailableContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(c.pos)||
!c||500>c.store.getFreeCapacity(RESOURCE_ENERGY))Memory.new_tasks.redistribute.splice(b,1),b--}Memory.new_tasks.redistribute=Memory.new_tasks.redistribute||[];b={};c=$jscomp.makeIterator(a);for(var d=c.next();!d.done;b={$jscomp$loop$prop$storage$79:b.$jscomp$loop$prop$storage$79},d=c.next())b.$jscomp$loop$prop$storage$79=d.value,findBestAvailableContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(b.$jscomp$loop$prop$storage$79.pos)&&!Memory.new_tasks.redistribute.find(function(a){return function(b){return b.id===
a.$jscomp$loop$prop$storage$79.id}}(b))&&(d={id:b.$jscomp$loop$prop$storage$79.id||"",name:"redistribute",priority:0},prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(d,b.$jscomp$loop$prop$storage$79.structureType),Memory.new_tasks.redistribute.push(d))};function prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(a,b){a.priority=REDISTRIBUTE_DEFAULT_PRIORITY$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.take=function(a,b){var c=Game.getObjectById(b.id);if(!c)return null;c=findBestAvailableContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(c.pos);if(!c)return null;a=Math.min(c.store[RESOURCE_ENERGY],a.store.getCapacity(RESOURCE_ENERGY));b.expected_fillup=b.expected_fillup?b.expected_fillup+a:a;reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(b);var d={};d.creep_exp_fill=
a;d.store_id=c.id;d.id=b.id;d.name=b.name;return d};function reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(a){a.expected_fillup||(a.expected_fillup=0);var b=a.expected_fillup,c=Game.getObjectById(a.id);!c||b>=c.store.getFreeCapacity(RESOURCE_ENERGY)?a.priority=0:prioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(a,c.structureType)}
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.finish=function(a,b){(a=findQueueTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(b.name,b.id))&&a.expected_fillup&&(a.expected_fillup-=b.creep_exp_fillup);a&&reprioritize$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute(a)};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.estimateTime=function(a,b,c){if(100>a.store.getFreeCapacity(RESOURCE_ENERGY))return Infinity;var d=Game.getObjectById(b.id);if(!d)return Infinity;var e=a.pos.findClosestByRange(FIND_STRUCTURES,{filter:function(a){return a.structureType==STRUCTURE_CONTAINER&&a.store[RESOURCE_ENERGY]>.5*a.store.getCapacity(RESOURCE_ENERGY)}});if(!e)return Infinity;b=a.pos.estimatePathCosts(e.pos,1,a,c);if(Infinity<=b)return Infinity;a=e.pos.estimatePathCosts(d.pos,
1,a,c-b);return Infinity<=a?Infinity:a+b};task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.spawn=function(a,b){if(500<b.room.storedEnergy()){var c=[MOVE,CARRY,CARRY];a=[MOVE,CARRY]}else c=[MOVE,CARRY,CARRY,WORK],a=[MOVE,MOVE,CARRY,WORK];for(var d="Yak"+Game.time,e=0;0==b.spawnCreep(c,d,{dryRun:!0});)c.push(a[e]),e=(e+1)%a.length;c.pop();return 3<c.length&&b.spawnCreep(c,d,{})==OK?d:""};
task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.creepAfter=function(a,b){b=Game.getObjectById(b.id);var c=b.pos.getAdjacentGenerallyWalkables();if(0==c.length)return error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(b," is unreachable!"),null;c=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(c[0],a.body.map(function(a){return a.type}),"Franky");a=a.store[RESOURCE_ENERGY]||a.store.getFreeCapacity(RESOURCE_ENERGY);b=Math.min(a,
b.store.getFreeCapacity(RESOURCE_ENERGY));c.store[RESOURCE_ENERGY]=a-b;return c};task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.state_array=[new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(takeFromStore$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task),new State$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(fillStructure$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task)];
var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute.task=task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute;var task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler={upgrade:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Upgrade,build:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Build,fill_store:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStore,repair:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Repair,claim_room:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_ClaimRoom,
fill_structure:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_FillStructure,kite:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Kite,attack_source_keeper:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task_Attack_SourceKeeper,redistribute:task$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Redistribute};
function updateTaskQueue$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(){for(var a in task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler)task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.hasOwnProperty(a)&&task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[a].updateQueue&&task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[a].hasOwnProperty("updateQueue")&&task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[a].updateQueue()}
function runTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b){a.memory.task&&a.memory.task.name&&(a.say(Math.floor(a.memory.task.estimated_time)+" "+a.memory.ticks),++a.memory.ticks,task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[a.memory.task.name].run(a)||completeTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a));a.memory.task&&a.memory.task.name||(a.memory.task_queue&&a.memory.task_queue.length?(a.memory.task=a.memory.task_queue.shift(),
runTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b-1)):(Memory.ready_queue=Memory.ready_queue||[],Memory.ready_queue.find(function(b){return b===a.name})||Memory.ready_queue.push(a.name)))}
function schedule$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(){var a=[];for(d in Memory.new_tasks)for(var b=$jscomp.makeIterator(Memory.new_tasks[d]),c=b.next();!c.done;c=b.next())a.push(c.value);a.sort(function(a,b){return b.priority-a.priority});for(c=0;5>c&&0<Memory.ready_queue.length;++c){var d=Memory.ready_queue.shift();if(d=Game.creeps[d])assignTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(d,a),runTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(d,
0)}a=[];for(var e in Memory.new_tasks)for(d=$jscomp.makeIterator(Memory.new_tasks[e]),c=d.next();!c.done;c=d.next())a.push(c.value);a.sort(function(a,b){return b.priority-a.priority});e=Game.getOurRooms(function(a){return a.hasExcessEnergy(1E3)}).flatMap(function(a){return a.findSpawns(function(a){return!a.spawning})});c=e.length;for(d=0;d<c&&a.length&&a[0].priority>=1*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants;++d){b=a.shift();var f=Game.getObjectById(b.id);
if(f&&(f=f.pos.findClosestTarget(e))&&f.allowSpawn()){info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("spawning for: ",b.name," - ",b.priority,"   ",b.id," ",Game.getObjectById(b.id).pos);e.splice(e.indexOf(f),1);var g=Game.numCreeps(),h=Game.getOurRooms().length;2>Math.floor(g/h)?f.spawnKevin():(g=void 0,g=task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].hasOwnProperty("spawn")?task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].spawn(b,
f):f.spawnKevin(),""!==g&&(f=new Frankencreep$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$FrankenCreep(f.pos,[WORK,CARRY,MOVE],g),f.memory.spawning=!0,b=task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].take(f,b),f.memory.task=b))}}}
function assignTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b){if(a.memory.role===Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SCOUT)a.memory.task={name:"claim_room"};else if(a.memory.role===Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.ARCHER)a.memory.task={name:"kite"};else if(a.memory.role===Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.SLAYER)a.memory.task={name:"attack_source_keeper"};else if(a.memory.task_queue&&
a.memory.task_queue.length)a.memory.task=a.memory.task_queue.shift();else{a.say("reschedule");a.memory.task_queue=a.memory.task_queue||[];var c=getNextTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b);a.memory.task=c;var d=0;c&&(d=Math.min(c.estimated_time,100));for(var e=a;c;){e=task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[c.name].creepAfter(e,c);if(!e)break;(c=getNextTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(e,b,d/a.memory.task_queue.length))&&
a.memory.task_queue.push(c)}}}
function completeTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a){info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(a.id," is completing task ",a.memory.task.name);var b=a.memory.task;task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].finish&&task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].hasOwnProperty("finish")&&(info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging(a.id," is calling finish for ",
a.memory.task.name),task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[b.name].finish(a,b));a.memory.old_task=a.memory.task;a.memory.ticks=0;a.memory.task=null}function increasePriorities$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(){for(var a in Memory.new_tasks)for(var b=$jscomp.makeIterator(Memory.new_tasks[a]),c=b.next();!c.done;c=b.next())c=c.value,c.hasOwnProperty("priority")&&c.priority++}
function getPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b,c){var d=b.id&&Game.getObjectById(b.id);if(!d)return 0;b=getEnergyForTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,b,c);return b.incomplete?Infinity:(b=b.object)?a.pos.findPathTo(b.pos).length+b.pos.findPathTo(d.pos).length:a.pos.findPathTo(d.pos).length}
function getNextTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,b,c){var d=-1,e=null,f=void 0,g=!1;b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;h=b.next()){h=h.value;if(g&&Game.cpu.getUsed()>=Game.cpu.limit)break;var k=Math.floor(h.priority/PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants)*PRIORITY_LEVEL_STEP$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,l=g?k/d:c;if(l&&2>l)break;if(task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[h.name].hasOwnProperty("estimateTime")){var n=
Game.cpu.getUsed();var m=task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[h.name].estimateTime(a,h,l);Infinity>m&&(m+=1);var p=Game.cpu.getUsed();1<p-n&&warning$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Estimate time for ",h," too expensive, took ",p-n," max cost ",l)}else m=getPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(a,h,l)+1;Infinity<=m||(isNaN(m)&&error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Path costs NaN, task ",
h),g=!0,k/=m,null!==k&&k>d&&(d=k,e=h,f=m))}if(!e)return null;c=e;info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Taking task: ",c);if("function"===typeof task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[c.name].take&&task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[c.name].hasOwnProperty("take"))return a=task_mapping$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler[c.name].take(a,c),a.estimated_time=f,a;warning$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("take function not implemented for ",
c.name);c.priority=0;d={};Object.assign(d,c);d.id=c.id;d.name=c.name;Object.assign(d,getEnergyForTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Task$Task(a,c).task);if(!d.id||!d.name)return null;d.estimated_time=f;return d}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.completeTask=completeTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.getNextTask=getNextTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.getPath=getPath$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.increasePriorities=increasePriorities$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;
module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.runTask=runTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.schedule=schedule$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler.updateTaskQueue=updateTaskQueue$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler;function monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){monitorBuildRoadTasks$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine();0==Game.time%100&&(monitorExtensionBuilding$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(),monitorBuildContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(),monitorTowerBuilding$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine())}
function findCentralPoint$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){for(var b=0,c=0,d=0;d<a.length;d++)b+=a[d].x,c+=a[d].y;b=parseInt(b/a.length,10);c=parseInt(c/a.length,10);return{x:b,y:c}}
function findClosestValidPosition$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a,b){for(var c=0;50>c;++c)for(var d=-c;d<=c;++d)for(var e=-c;e<=c;++e)if((d==c||e==c||d==-c||e==-c)&&Game.rooms[a.roomName].inRoom({x:a.x+d,y:a.y+e})){var f=new RoomPosition(a.x+d,a.y+e,a.roomName);if(b(f))return f}return null}
function hasDistance$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a,b){var c=Game.rooms[a.roomName],d=c.find(FIND_STRUCTURES,{filter:function(a){return a.structureType!=STRUCTURE_ROAD}}),e=c.find(FIND_CONSTRUCTION_SITES,{filter:function(a){return a.structureType!=STRUCTURE_ROAD}}),f=c.find(FIND_MINERALS);c=c.find(FIND_SOURCES);d=$jscomp.makeIterator(d.concat(e).concat(f).concat(c).map(function(a){return a.pos}));for(e=d.next();!e.done;e=d.next())if(a.inRangeTo(e.value,b))return!1;
return!0}
function monitorExtensionBuilding$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){var a=Game.getOurRooms();a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if(b=b.value,canBuildExtension$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b)){var c=b.find(FIND_SOURCES),d=findCentralPoint$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(c.map(function(a){return a.pos})),e=d.x;d=d.y;for(var f=0,g=0,h=0;;){h++;if(1E3<h)break;var k=e+f,
l=d+g;if(0<k&&49>k&&0<l&&49>l){var n=!0;5>(new RoomPosition(k,l,b.name)).getAdjacentWalkables().length&&(n=!1);for(var m=$jscomp.makeIterator(b.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_SPAWN||a.structureType===STRUCTURE_STORAGE||a.structureType===STRUCTURE_TOWER||a.structureType===STRUCTURE_CONTAINER||a.structureType===STRUCTURE_WALL}})||[]),p=m.next();!p.done;p=m.next())3>p.value.pos.getRangeTo(k,l)&&(n=!1);m=$jscomp.makeIterator(c||[]);for(p=m.next();!p.done;p=
m.next())3>p.value.pos.getRangeTo(k,l)&&(n=!1);if(n&&b.createConstructionSite(k,l,STRUCTURE_EXTENSION)===OK)break}g=$jscomp.makeIterator(walk45DegRect$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(f,g));f=g.next().value;g=g.next().value}}}
function canBuildExtension$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){var b=CONTROLLER_STRUCTURES.extension[a.controller.level];return a.find(FIND_STRUCTURES,{filter:{structureType:STRUCTURE_EXTENSION}}).length<b?!0:!1}function walk45DegRect$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a,b){0===a&&0===b&&(a=-2);0>a&&0<=b?(a++,b++):0<=a&&0<b?(a++,b--):0<a&&0>=b?(a--,b--):0>=a&&0>b&&(a--,b++,0>a&&0==b&&(a-=2));return[a,b]}
function monitorBuildContainer$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){var a=Game.getOurRooms();a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var c=b.find(FIND_STRUCTURES,{filter:{structureType:STRUCTURE_CONTAINER}}).length,d=b.find(FIND_CONSTRUCTION_SITES,{filter:{structureType:STRUCTURE_CONTAINER}}).length;5>c+d&&placeContainers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b)}}
function placeContainers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){var b=a.find(FIND_SOURCES)||[];b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next()){c=c.value;var d=1;a:for(;4>d;++d)for(var e=-d;e<=d;++e)for(var f=-d;f<=d;++f){var g={x:c.pos.x+e,y:c.pos.y+f};if(a.inRoom(g))if(g=a.createConstructionSite(g.x,g.y,STRUCTURE_CONTAINER),g===OK)break a;else{if(g===ERR_RCL_NOT_ENOUGH||g===ERR_FULL)return;g!==ERR_INVALID_TARGET&&error$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("BM.placeContainers: invalid return value")}}}}
function max_road_number$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){return 1*Game.numCreeps(function(a){return!0})*(getTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base(a,function(a){return!0}).length+1)}
function monitorBuildRoadTasks$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){"number"!==typeof Memory.road_build_counter&&(Memory.road_build_counter=0);Memory.road_build_counter++;snapshot$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine();if(Memory.road_build_counter>AUTOMATIC_ROAD_BUILD_TICKS$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants){for(var a=$jscomp.makeIterator(Game.getOurRooms()||[]),b=a.next();!b.done;b=a.next())createBuildRoadTasks$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b.value);
Memory.road_build_counter=0}}function snapshot$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){Memory.roads||(Memory.roads=new Map);for(var a=$jscomp.makeIterator(Object.values(Game.creeps)),b=a.next();!b.done;b=a.next()){b=b.value;var c=b.room;Memory.roads[c.name]||(Memory.roads[c.name]=Array(50).fill(Array(50).fill(0)));b.fatigue&&Memory.roads[c.name][b.pos.y][b.pos.x]++}}
function createBuildRoadTasks$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){var b=a.find(FIND_STRUCTURES,{filter:function(a){return a.structureType==STRUCTURE_ROAD}}).length;if(b>=max_road_number$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a))info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Not building any roads because we already have "+b);else{b=[];for(var c=0;50>c;c++)for(var d=0;50>d;d++)Memory.roads[a.name][c][d]&&b.push({x:d,y:c,
val:Memory.roads[a.name][c][d]}),Memory.roads[a.name][c][d]=0;b.sort(function(a,b){return b.val-a.val});for(c=0;c<Math.min(AUTOMATIC_ROAD_BUILD_NUM$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants,b.length);c++)d=new RoomPosition(b[c].x,b[c].y,a.name),d.createConstructionSite(STRUCTURE_ROAD),info$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Logging("Spawning road construction site at ",d)}}
function monitorTowerBuilding$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(){var a=Game.getOurRooms();a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,canBuildTower$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b)&&(b=findTowerPos$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b))&&b.createConstructionSite(STRUCTURE_TOWER)}
function canBuildTower$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){var b=CONTROLLER_STRUCTURES.tower[a.controller.level];return a.find(FIND_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}}).length<b?!0:!1}
function findTowerPos$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a){var b=a.find(FIND_STRUCTURES).concat(a.find(FIND_CONSTRUCTION_SITES));b=findCentralPoint$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(b.map(function(a){return a.pos}));a=new RoomPosition(b.x,b.y,a.name);return findClosestValidPosition$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a,function(a){return a.isGenerallyWalkable()&&5<a.getAdjacentWalkables().length&&hasDistance$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine(a,
3)})}var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine={};module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine.monitor=monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine;module.exports.loop=function(){for(var a in Memory.new_tasks)for(var b=$jscomp.makeIterator(Memory.new_tasks[a]),c=b.next();!c.done;c=b.next()){c=c.value;var d=Game.getObjectById(c.id);d&&(new RoomVisual(d.room.name)).text(""+Math.floor(c.priority),d.pos.x,d.pos.y,{align:"right",font:.4})}initGame$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Game();handlePossibleRespawn$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Base();increasePriorities$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler();
monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$BuildMachine();operateTowers$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Tower();Memory.new_tasks=Memory.new_tasks||{};0===Game.time%1&&updateTaskQueue$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler();monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Defense();a=$jscomp.makeIterator(Object.values(Game.creeps));for(b=a.next();!b.done;b=a.next()){b=b.value;b.memory.spawning=void 0;if(b.room.controller&&
!b.room.controller.safeMode&&b.memory.role!=Role$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Constants.ARCHER&&(c=b.pos.findInRange(FIND_HOSTILE_CREEPS,3),0<c.length)){b.moveAwayFrom(c[0],3);continue}runTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler(b,1)}schedule$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler();monitor$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$SpawnMachine();for(var e in Memory.creeps)if(!Game.creeps[e]&&!Memory.creeps[e].spawning){for(Memory.creeps[e].task&&
completeTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler({memory:Memory.creeps[e]});Memory.creeps[e].task_queue&&Memory.creeps[e].task_queue.length;)Memory.creeps[e].task=Memory.creeps[e].task_queue.shift(),completeTask$$module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$Scheduler({memory:Memory.creeps[e]});delete Memory.creeps[e]}};var module$c_$Users$bt121073$Documents$CreepOS2$CreepOS$main={};
//# sourceMappingURL=main.min.js.map
